!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):n.windowsGetApps=e()}(this,function(){const n=function(){function n(){}return n.prototype.then=function(t,r){const o=new n,i=this.s;if(i){const n=1&i?t:r;if(n){try{e(o,1,n(this.v))}catch(n){e(o,2,n)}return o}return this}return this.o=function(n){try{const i=n.v;1&n.s?e(o,1,t?t(i):i):r?e(o,1,r(i)):e(o,2,i)}catch(n){e(o,2,n)}},o},n}();function e(t,r,o){if(!t.s){if(o instanceof n){if(!o.s)return void(o.o=e.bind(null,t,r));1&r&&(r=o.s),o=o.v}if(o&&o.then)return void o.then(e.bind(null,t,r),e.bind(null,t,2));t.s=r,t.v=o;const i=t.o;i&&i(t)}}function t(e){return e instanceof n&&1&e.s}const r="undefined"!=typeof Symbol?Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator")):"@@iterator";function o(o,i,u){if("function"==typeof o[r]){var s,f,c,a=o[r]();if(function r(o){try{for(;!((s=a.next()).done||u&&u());)if((o=i(s.value))&&o.then){if(!t(o))return void o.then(r,c||(c=e.bind(null,f=new n,2)));o=o.v}f?e(f,1,o):f=o}catch(t){e(f||(f=new n),2,t)}}(),a.return){var l=function(n){try{s.done||a.return()}catch(n){}return n};if(f&&f.then)return f.then(l,function(n){throw l(n)});l()}return f}if(!("length"in o))throw new TypeError("Object is not iterable");for(var h=[],d=0;d<o.length;d++)h.push(o[d]);return function(r,o,i){var u,s,f=-1;return function c(a){try{for(;++f<r.length&&(!i||!i());)if((a=o(f))&&a.then){if(!t(a))return void a.then(c,s||(s=e.bind(null,u=new n,2)));a=a.v}u?e(u,1,a):u=a}catch(t){e(u||(u=new n),2,t)}}(),u}(h,function(n){return i(h[n])},u)}"undefined"!=typeof Symbol&&(Symbol.asyncIterator||(Symbol.asyncIterator=Symbol("Symbol.asyncIterator")));var i=require("path"),u=require("fs-promise"),s=u.readFilePaths,f=u.writeFile,c=u.exists,a=require("extract-file-icon"),l=function(n,e){try{return Promise.resolve(function(n,e){try{for(var t=[],r={},o=0,u=n;o<u.length;o+=1)t.push(s(u[o],function(n){return e.includes(i.extname(n))}));return Promise.resolve(Promise.all(t)).then(function(n){for(var e=0,t=n;e<t.length;e+=1)for(var o=0,i=t[e];o<i.length;o+=1)r[i[o]]="";return Object.keys(r)})}catch(n){return Promise.reject(n)}}(n,e)).then(function(n){function e(){return Promise.resolve(Promise.all(r)).then(function(){return t})}var t=[],r=[],u=o(n,function(n){var e=i.basename(n).replace(i.extname(n),""),o=i.resolve(".","apps",e+".png");return t.push({name:e,icon:o}),Promise.resolve(c(o)).then(function(e){e||r.push(f(o,a(n,32)))})});return u&&u.then?u.then(e):e()})}catch(n){return Promise.reject(n)}};return function(n,e){void 0===n&&(n=[]),void 0===e&&(e=[]);for(var t=[".appref-ms",".exe",".lnk",".bat",".url"],r=["C:\\Users\\Default\\Links","C:\\Users\\Default\\Desktop","C:\\Users\\Administrator\\Desktop","C:\\Users\\Default\\AppData\\Roaming\\Microsoft\\Internet Explorer","C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs"],o=0,i=n;o<i.length;o+=1){var u=i[o];r.includes(u)||r.push(u)}for(var s=0,f=e;s<f.length;s+=1){var c=f[s];t.includes(c)||t.push(c)}return l(r,t)}});
