const n=function(){function n(){}return n.prototype.then=function(e,t){const o=new n,i=this.s;if(i){const n=1&i?e:t;if(n){try{r(o,1,n(this.v))}catch(n){r(o,2,n)}return o}return this}return this.o=function(n){try{const i=n.v;1&n.s?r(o,1,e?e(i):i):t?r(o,1,t(i)):r(o,2,i)}catch(n){r(o,2,n)}},o},n}();function r(e,t,o){if(!e.s){if(o instanceof n){if(!o.s)return void(o.o=r.bind(null,e,t));1&t&&(t=o.s),o=o.v}if(o&&o.then)return void o.then(r.bind(null,e,t),r.bind(null,e,2));e.s=t,e.v=o;const i=e.o;i&&i(e)}}function e(r){return r instanceof n&&1&r.s}const t="undefined"!=typeof Symbol?Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator")):"@@iterator";function o(o,i,u){if("function"==typeof o[t]){var s,c,f,a=o[t]();if(function t(o){try{for(;!((s=a.next()).done||u&&u());)if((o=i(s.value))&&o.then){if(!e(o))return void o.then(t,f||(f=r.bind(null,c=new n,2)));o=o.v}c?r(c,1,o):c=o}catch(e){r(c||(c=new n),2,e)}}(),a.return){var l=function(n){try{s.done||a.return()}catch(n){}return n};if(c&&c.then)return c.then(l,function(n){throw l(n)});l()}return c}if(!("length"in o))throw new TypeError("Object is not iterable");for(var h=[],v=0;v<o.length;v++)h.push(o[v]);return function(t,o,i){var u,s,c=-1;return function f(a){try{for(;++c<t.length&&(!i||!i());)if((a=o(c))&&a.then){if(!e(a))return void a.then(f,s||(s=r.bind(null,u=new n,2)));a=a.v}u?r(u,1,a):u=a}catch(e){r(u||(u=new n),2,e)}}(),u}(h,function(n){return i(h[n])},u)}"undefined"!=typeof Symbol&&(Symbol.asyncIterator||(Symbol.asyncIterator=Symbol("Symbol.asyncIterator")));var i=require("path"),u=require("fs-promise"),s=u.readdir,c=u.writeFile,f=u.isDir,a=u.exists,l=require("extract-file-icon"),h=function(n,r){try{return Promise.resolve(s(n)).then(function(e){var t=[],u=o(e,function(e){var o=i.join(n,e);return Promise.resolve(f(o)).then(function(n){function e(){function n(n){r&&!1===n||t.push(o)}return r?Promise.resolve(r(o)).then(n):n(r)}var i=function(){if(n){var e=t.push;return Promise.resolve(h(o,r)).then(function(n){e.call.apply(e,[t].concat(n))})}}();return i&&i.then?i.then(e):e()})});return u&&u.then?u.then(function(){return t}):t})}catch(n){return Promise.reject(n)}},v=function(n,r){try{return Promise.resolve(function(n,r){try{for(var e=[],t={},o=0,u=n;o<u.length;o+=1)e.push(h(u[o],function(n){return r.includes(i.extname(n))}));return Promise.resolve(Promise.all(e)).then(function(n){for(var r=0,e=n;r<e.length;r+=1)for(var o=0,i=e[r];o<i.length;o+=1)t[i[o]]="";return Object.keys(t)})}catch(n){return Promise.reject(n)}}(n,r)).then(function(n){function r(){return Promise.resolve(Promise.all(t)).then(function(){return e})}var e=[],t=[],u=o(n,function(n){var r=i.basename(n).replace(i.extname(n),""),o=i.resolve(".","apps",r+".png").replace(/\\/g,"/");return e.push({name:r,icon:o}),Promise.resolve(a(o)).then(function(r){r||t.push(c(o,l(n,32)))})});return u&&u.then?u.then(r):r()})}catch(n){return Promise.reject(n)}};module.exports=function(n,r){void 0===n&&(n=[]),void 0===r&&(r=[]);for(var e=[".appref-ms",".exe",".lnk",".bat",".url"],t=["C:\\Users\\Default\\Links","C:\\Users\\Default\\Desktop","C:\\Users\\Administrator\\Desktop","C:\\Users\\Default\\AppData\\Roaming\\Microsoft\\Internet Explorer","C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs"],o=0,i=n;o<i.length;o+=1){var u=i[o];t.includes(u)||t.push(u)}for(var s=0,c=r;s<c.length;s+=1){var f=c[s];e.includes(f)||e.push(f)}return v(t,e)};
